+ SUBJECT_SESSION=sub-Control01/ses-avanto02
++ date +%s
+ start=1716381991
+ sct_check_dependencies -short

--
Spinal Cord Toolbox (6.3)

sct_check_dependencies -short
--


SYSTEM INFORMATION
------------------
SCT info:
- version: 6.3
- path: /Users/mathilde/sct_6.3
OS: osx (macOS-10.16-x86_64-i386-64bit)
CPU cores: Available: 10, Used by ITK functions: 1
RAM: Total: 65536MB, Used: 4556MB, Available: 10744MB
++ cut -d / -f1
+ SUBJECT=sub-Control01
++ cut -d / -f2
+ SESSION=ses-avanto02
+ cd /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/data_processed
+ [[ ! -f participants.tsv ]]
+ rsync -avzh /Users/mathilde/Desktop/BIDS_DATASET_copy_4/DATA/participants.tsv .
building file list ... rsync: link_stat "/Users/mathilde/Desktop/BIDS_DATASET_copy_4/DATA/participants.tsv" failed: No such file or directory (2)
done

sent 29 bytes  received 20 bytes  98.00 bytes/sec
total size is 0  speedup is 0.00
rsync error: some files could not be transferred (code 23) at /AppleInternal/Library/BuildRoots/a0876c02-1788-11ed-b9c4-96898e02b808/Library/Caches/com.apple.xbs/Sources/rsync/rsync/main.c(996) [sender=2.6.9]
+ mkdir -p sub-Control01
+ rsync -avzh --copy-links /Users/mathilde/Desktop/BIDS_DATASET_copy_4/DATA/sub-Control01/ses-avanto02 sub-Control01/
building file list ... done
ses-avanto02/
ses-avanto02/.DS_Store
ses-avanto02/anat/
ses-avanto02/anat/.DS_Store
ses-avanto02/anat/sub-Control01_ses-avanto02_acq-mprage_T1w.nii.gz

sent 10.26M bytes  received 98 bytes  6.84M bytes/sec
total size is 10.27M  speedup is 1.00
+ cd sub-Control01/ses-avanto02/anat/
+ SUBJECT=sub-Control01_ses-avanto02
++ find . -type f -name '*_T1w.nii.gz' -print
++ head -n 1
+ T1_image=./sub-Control01_ses-avanto02_acq-mprage_T1w.nii.gz
+ sct_deepseg -i ./sub-Control01_ses-avanto02_acq-mprage_T1w.nii.gz -task seg_sc_contrast_agnostic -o ./sub-Control01_ses-avanto02_acq-mprage_T1w.nii_seg.nii.gz -qc /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/qc -qc-subject sub-Control01_ses-avanto02

--
Spinal Cord Toolbox (6.3)

sct_deepseg -i ./sub-Control01_ses-avanto02_acq-mprage_T1w.nii.gz -task seg_sc_contrast_agnostic -o ./sub-Control01_ses-avanto02_acq-mprage_T1w.nii_seg.nii.gz -qc /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/qc -qc-subject sub-Control01_ses-avanto02
--

Creating temporary folder (/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-46-46_sct_deepseg_zo7fnmkq)
Copied ./sub-Control01_ses-avanto02_acq-mprage_T1w.nii.gz to /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-46-46_sct_deepseg_zo7fnmkq/sub-Control01_ses-avanto02_acq-mprage_T1w.nii.gz
Starting inference...
Inference done.
Total inference time: 1 minute(s) 53 seconds
Saving results to: /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-46-46_sct_deepseg_zo7fnmkq/sub-Control01_ses-avanto02_acq-mprage_T1w_seg.nii.gz
[33mImage header specifies datatype 'float32', but array is of type '<class 'numpy.uint8'>'. Header metadata will be overwritten to use '<class 'numpy.uint8'>'.[0m

*** Generating Quality Control (QC) html report ***
Resample images to 0.600000x0.600000 vox
[33mConverting image from type 'int16' to type 'float64' for spline interpolation[0m
[33mConverting image from type 'uint8' to type 'float64' for linear interpolation[0m
Find the center of each slice
/Users/mathilde/sct_6.3/python/envs/venv_sct/lib/python3.9/site-packages/scipy/ndimage/_measurements.py:1542: RuntimeWarning: invalid value encountered in scalar divide
  results = [sum(input * grids[dir].astype(float), labels, index) / normalizer
Successfully generated the QC results in /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/qc/_json/qc_2024_05_22_144952.065984.json

To see the results in a browser, type:
open /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/qc/index.html


Done! To view results, type:
fsleyes sub-Control01_ses-avanto02_acq-mprage_T1w.nii.gz -cm greyscale sub-Control01_ses-avanto02_acq-mprage_T1w.nii_seg.nii.gz -cm red -a 70.0 &

+ sct_label_vertebrae -i ./sub-Control01_ses-avanto02_acq-mprage_T1w.nii.gz -s ./sub-Control01_ses-avanto02_acq-mprage_T1w.nii_seg.nii.gz -ofolder label_vertebrae -c t1 -qc /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/qc -qc-subject sub-Control01_ses-avanto02

--
Spinal Cord Toolbox (6.3)

sct_label_vertebrae -i ./sub-Control01_ses-avanto02_acq-mprage_T1w.nii.gz -s ./sub-Control01_ses-avanto02_acq-mprage_T1w.nii_seg.nii.gz -ofolder label_vertebrae -c t1 -qc /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/qc -qc-subject sub-Control01_ses-avanto02
--

Creating temporary folder (/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_label-vertebrae_zmnxf0d5)

Copying input data to tmp folder...

Straighten spinal cord...
Creating temporary folder (/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_straighten-spinalcord_eb4ekr79)
Copy files to tmp folder...
Fitting centerline using B-spline approximation
Error on approximation = 0.07 mm
Error on approximation = 0.02 mm
Error on approximation = 0.03 mm
Error on approximation = 0.02 mm
Error on approximation = 0.01 mm
Error on approximation = 0.01 mm
Create the straight space and the safe zone
Length of spinal cord: 75.32139115228405
Size of spinal cord in z direction: 73.97882139800386
Ratio length/size: 1.0181480284344786
Safe zone boundaries (curved space): [-111.33321952222084, -37.354398124216985]
Safe zone boundaries (straight space): [-112.00450439936094, -36.68311324707689]
Pad input volume to account for spinal cord length...
Time to generate centerline: 16.0 ms
[33mImage header specifies datatype 'float32', but array is of type 'float64'. Header metadata will be overwritten to use 'float64'.[0m
Warping field generated: tmp.curve2straight.nii.gz
[33mImage header specifies datatype 'float32', but array is of type 'float64'. Header metadata will be overwritten to use 'float64'.[0m
Warping field generated: tmp.straight2curve.nii.gz
Apply transformation to input image...
/Users/mathilde/sct_6.3/bin/isct_antsApplyTransforms -d 3 -i data.nii -o tmp.anat_rigid_warp.nii.gz -t tmp.curve2straight.nii.gz -r tmp.centerline_pad_crop.nii.gz -n 'BSpline[3]' # in /private/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_straighten-spinalcord_eb4ekr79
Generate output files...
mv /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_straighten-spinalcord_eb4ekr79/tmp.curve2straight.nii.gz ./warp_curve2straight.nii.gz
File created: ./warp_curve2straight.nii.gz
mv /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_straighten-spinalcord_eb4ekr79/tmp.straight2curve.nii.gz ./warp_straight2curve.nii.gz
File created: ./warp_straight2curve.nii.gz
cp /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_straighten-spinalcord_eb4ekr79/tmp.anat_rigid_warp.nii.gz ./straight_ref.nii.gz
File created: ./data_straight.nii
Remove temporary files...
rm -rf /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_straighten-spinalcord_eb4ekr79

Resample to 0.5mm isotropic...
load data...

Apply straightening to segmentation...
/Users/mathilde/sct_6.3/bin/isct_antsApplyTransforms -d 3 -i segmentation.nii -o segmentation_straight.nii -t warp_curve2straight.nii.gz -r data_straightr.nii -n Linear # in /private/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_label-vertebrae_zmnxf0d5
[33mFile /private/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_label-vertebrae_zmnxf0d5/segmentation_straight.nii already exists. Will overwrite it.[0m

Create label to identify disc...
Creating temporary folder...
Creating temporary folder (/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-55_detect-c2c3_my9e1_0s)
Run C2-C3 detector...
C2-C3 detected...
Remove temporary files...
rm -rf /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-55_detect-c2c3_my9e1_0s
[33mFile /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_label-vertebrae_zmnxf0d5/labelz.nii.gz already exists. Will overwrite it.[0m

And apply straightening to label...
/Users/mathilde/sct_6.3/bin/isct_antsApplyTransforms -d 3 -i labelz.nii.gz -o labelz_straight.nii.gz -t warp_curve2straight.nii.gz -r data_straightr.nii -n NearestNeighbor # in /private/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_label-vertebrae_zmnxf0d5

Get z and disc values from straight label...
.. [76, 3]
Look for template...
Path template: /Users/mathilde/sct_6.3/data/PAM50
Open template and vertebral levels...
Disc values from template: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Z-values for each disc: [984, 938, 907, 870, 833, 800, 769, 735, 692, 646, 600, 551, 500, 449, 396, 342, 289, 231, 168, 105, 39]
Distances between discs (in voxel): [46.0, 31.0, 37.0, 37.0, 33.0, 31.0, 34.0, 43.0, 46.0, 46.0, 49.0, 51.0, 51.0, 53.0, 54.0, 53.0, 58.0, 63.0, 63.0, 66.0]
Detect intervertebral discs...
Current disc: 2 (z=76). Direction: superior
.. Peak found: z=-2 (correlation = 0.47513415856158)
Current disc: 1 (z=105). Direction: superior
.. correcting factor: 1.0
.. Switching to inferior direction.
Current disc: 3 (z=39). Direction: inferior
.. Peak found: z=-10 (correlation = 0.5383779699403892)
.. correcting factor: 1.1081081081081081
Adding top disc based on adjusted template distance: #0
.. approximate distance: 51

Un-straighten labeling...
/Users/mathilde/sct_6.3/bin/isct_antsApplyTransforms -d 3 -i segmentation_straight_labeled.nii -o segmentation_labeled.nii -t warp_straight2curve.nii.gz -r segmentation.nii -n NearestNeighbor # in /private/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_label-vertebrae_zmnxf0d5

Cleaning labeled segmentation:
  removing labeled voxels outside segmentation...
Done cleaning.
[33mFile /private/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_label-vertebrae_zmnxf0d5/segmentation_labeled.nii already exists. Will overwrite it.[0m

Label discs...

Un-straighten labeled discs...

Dilate labels before warping...
Creating temporary folder (/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-51-05_apply-transfo-3d-label_zxtp0sti)
/Users/mathilde/sct_6.3/bin/isct_antsApplyTransforms -d 3 -i /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-51-05_apply-transfo-3d-label_zxtp0sti/dilated_data.nii -o segmentation_labeled_disc.nii -t warp_straight2curve.nii.gz -r segmentation.nii -n NearestNeighbor # in /private/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_label-vertebrae_zmnxf0d5

Take the center of mass of each registered dilated labels...
[33mFile segmentation_labeled_disc.nii already exists. Will overwrite it.[0m

Generate output files...
File created: /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/data_processed/sub-Control01/ses-avanto02/anat/label_vertebrae/sub-Control01_ses-avanto02_acq-mprage_T1w.nii_seg_labeled.nii.gz
File created: /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/data_processed/sub-Control01/ses-avanto02/anat/label_vertebrae/sub-Control01_ses-avanto02_acq-mprage_T1w.nii_seg_labeled_discs.nii.gz
mv /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_label-vertebrae_zmnxf0d5/straightening.cache /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/data_processed/sub-Control01/ses-avanto02/anat/label_vertebrae/straightening.cache
File created: /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/data_processed/sub-Control01/ses-avanto02/anat/label_vertebrae/straightening.cache
mv /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_label-vertebrae_zmnxf0d5/warp_curve2straight.nii.gz /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/data_processed/sub-Control01/ses-avanto02/anat/label_vertebrae/warp_curve2straight.nii.gz
File created: /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/data_processed/sub-Control01/ses-avanto02/anat/label_vertebrae/warp_curve2straight.nii.gz
mv /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_label-vertebrae_zmnxf0d5/warp_straight2curve.nii.gz /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/data_processed/sub-Control01/ses-avanto02/anat/label_vertebrae/warp_straight2curve.nii.gz
File created: /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/data_processed/sub-Control01/ses-avanto02/anat/label_vertebrae/warp_straight2curve.nii.gz
mv /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_label-vertebrae_zmnxf0d5/straight_ref.nii.gz /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/data_processed/sub-Control01/ses-avanto02/anat/label_vertebrae/straight_ref.nii.gz
File created: /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/data_processed/sub-Control01/ses-avanto02/anat/label_vertebrae/straight_ref.nii.gz

Remove temporary files...
rm -rf /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_14-50-08_label-vertebrae_zmnxf0d5

*** Generate Quality Control (QC) html report ***
Resample images to NonexNone mm
QcImage: layout with Sagittal slice
/Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/qc/sub-Control01/sub-Control01_ses-avanto02/anat/sct_label_vertebrae/2024_05_22_145112.703314/background_img.png
Successfully generated the QC results in /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/qc/_json/qc_2024_05_22_145112.703314.json

To see the results in a browser, type:
open /Users/mathilde/Desktop/BIDS_DATASET_copy_4/OUTPUT/qc/index.html


Done! To view results, type:
fsleyes sub-Control01_ses-avanto02_acq-mprage_T1w.nii.gz -cm greyscale -a 100.0 label_vertebrae/sub-Control01_ses-avanto02_acq-mprage_T1w.nii_seg_labeled.nii.gz -cm subcortical -a 50.0 &

+ cd ..
+ FILES_TO_CHECK=("anat/${SUBJECT}_acq-mprage_T1w.nii_seg.nii.gz" "anat/${SUBJECT}_acq-mprage_T1w.nii_seg_labeled.nii.gz" "anat/${SUBJECT}_acq-mprage_T1w.nii_seg_labeled_discs.nii.gz")
+ for file in '${FILES_TO_CHECK[@]}'
+ [[ ! -e anat/sub-Control01_ses-avanto02_acq-mprage_T1w.nii_seg.nii.gz ]]
+ for file in '${FILES_TO_CHECK[@]}'
+ [[ ! -e anat/sub-Control01_ses-avanto02_acq-mprage_T1w.nii_seg_labeled.nii.gz ]]
+ echo 'sub-Control01_ses-avanto02/anat/sub-Control01_ses-avanto02_acq-mprage_T1w.nii_seg_labeled.nii.gz does not exist'
+ for file in '${FILES_TO_CHECK[@]}'
+ [[ ! -e anat/sub-Control01_ses-avanto02_acq-mprage_T1w.nii_seg_labeled_discs.nii.gz ]]
+ echo 'sub-Control01_ses-avanto02/anat/sub-Control01_ses-avanto02_acq-mprage_T1w.nii_seg_labeled_discs.nii.gz does not exist'
++ date +%s
+ end=1716382277
+ runtime=286
+ echo

+ echo '~~~'
~~~
++ sct_version
+ echo 'SCT version: 6.3'
SCT version: 6.3
++ uname -nsr
+ echo 'Ran on:      Darwin MacBookProKI.local 21.6.0'
Ran on:      Darwin MacBookProKI.local 21.6.0
+ echo 'Duration:    0hrs 4min 46sec'
Duration:    0hrs 4min 46sec
+ echo '~~~'
~~~
