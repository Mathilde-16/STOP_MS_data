+ SUBJECT_SESSION=sub-Control01/ses-aera01
++ date +%s
+ start=1716389512
+ sct_check_dependencies -short

--
Spinal Cord Toolbox (6.3)

sct_check_dependencies -short
--


SYSTEM INFORMATION
------------------
SCT info:
- version: 6.3
- path: /Users/mathilde/sct_6.3
OS: osx (macOS-10.16-x86_64-i386-64bit)
CPU cores: Available: 10, Used by ITK functions: 1
RAM: Total: 65536MB, Used: 3511MB, Available: 11731MB
++ cut -d / -f1
+ SUBJECT=sub-Control01
++ cut -d / -f2
+ SESSION=ses-aera01
+ cd /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/data_processed
+ [[ ! -f participants.tsv ]]
+ rsync -avzh /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/DATA/participants.tsv .
building file list ... rsync: link_stat "/Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/DATA/participants.tsv" failed: No such file or directory (2)
done

sent 29 bytes  received 20 bytes  98.00 bytes/sec
total size is 0  speedup is 0.00
rsync error: some files could not be transferred (code 23) at /AppleInternal/Library/BuildRoots/a0876c02-1788-11ed-b9c4-96898e02b808/Library/Caches/com.apple.xbs/Sources/rsync/rsync/main.c(996) [sender=2.6.9]
+ mkdir -p sub-Control01
+ rsync -avzh --copy-links /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/DATA/sub-Control01/ses-aera01 sub-Control01/
building file list ... done
ses-aera01/
ses-aera01/.DS_Store
ses-aera01/anat/
ses-aera01/anat/.DS_Store
ses-aera01/anat/sub-Control01_ses-aera01_acq-mprage_T1w.nii.gz

sent 8.34M bytes  received 98 bytes  16.68M bytes/sec
total size is 8.35M  speedup is 1.00
+ cd sub-Control01/ses-aera01/anat/
+ SUBJECT=sub-Control01_ses-aera01
++ find . -type f -name '*_T1w.nii.gz' -print
++ head -n 1
+ T1_image=./sub-Control01_ses-aera01_acq-mprage_T1w.nii.gz
+ sct_deepseg_sc -i ./sub-Control01_ses-aera01_acq-mprage_T1w.nii.gz -c t1 -centerline cnn -o ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_seg.nii.gz -qc /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/qc -qc-subject sub-Control01_ses-aera01

--
Spinal Cord Toolbox (6.3)

sct_deepseg_sc -i ./sub-Control01_ses-aera01_acq-mprage_T1w.nii.gz -c t1 -centerline cnn -o ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_seg.nii.gz -qc /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/qc -qc-subject sub-Control01_ses-aera01
--

Config deepseg_sc:
  Centerline algorithm: cnn
  Brain in image: True
  Kernel dimension: 2d
  Contrast: t1
  Threshold: 0.15
Creating temporary folder (/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-51-59_deepseg-sc_3ez8lqvm)
Reorient the image to RPI, if necessary...
[33mConverting image from type 'int16' to type 'float64' for linear interpolation[0m
Finding the spinal cord centerline...
[33mTo avoid intensity overflow due to convertion to +uint8+, intensity will be rescaled to the maximum quantization scale[0m
Brain section detected.
Creating temporary folder (/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-53-36_optic-detect-centerline_tcso1yoq)
[33mImage header specifies datatype 'uint8', but array is of type 'float64'. Header metadata will be overwritten to use 'float64'.[0m
Remove temporary files...
rm -rf /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-53-36_optic-detect-centerline_tcso1yoq
Cropping brain section.
Cropping the image around the spinal cord...
Normalizing the intensity...
Segmenting the spinal cord using deep learning on 2D patches...
Reassembling the image...
Resampling the segmentation to the native image resolution using linear interpolation...
Binarizing the resampled segmentation...
[33mImage header specifies datatype 'float32', but array is of type 'uint8'. Header metadata will be overwritten to use 'uint8'.[0m
[33mConverting image from type 'uint8' to type 'float64' for linear interpolation[0m
[33mFound isolated voxels on slice 0, Removing them[0m
Remove temporary files...
rm -rf /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-51-59_deepseg-sc_3ez8lqvm

*** Generate Quality Control (QC) html report ***
Resample images to 0.6x0.6 mm
[33mConverting image from type 'int16' to type 'float64' for spline interpolation[0m
[33mConverting image from type 'uint8' to type 'float64' for linear interpolation[0m
[33mImage header specifies datatype 'float64', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
QcImage: layout with Axial slice
Compute center of mass at each slice
/Users/mathilde/sct_6.3/python/envs/venv_sct/lib/python3.9/site-packages/scipy/ndimage/_measurements.py:1542: RuntimeWarning: invalid value encountered in scalar divide
  results = [sum(input * grids[dir].astype(float), labels, index) / normalizer
/Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/qc/sub-Control01/sub-Control01_ses-aera01/anat/sct_deepseg_sc/2024_05_22_165407.238302/background_img.png
Successfully generated the QC results in /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/qc/_json/qc_2024_05_22_165407.238302.json

To see the results in a browser, type:
open /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/qc/index.html


Done! To view results, type:
fsleyes sub-Control01_ses-aera01_acq-mprage_T1w.nii.gz -cm greyscale sub-Control01_ses-aera01_acq-mprage_T1w.nii_seg.nii.gz -cm red -a 70.0 &

+ sct_create_mask -i ./sub-Control01_ses-aera01_acq-mprage_T1w.nii.gz -p centerline,./sub-Control01_ses-aera01_acq-mprage_T1w.nii_seg.nii.gz -size 35mm -f cylinder -o ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_mask.nii.gz

--
Spinal Cord Toolbox (6.3)

sct_create_mask -i ./sub-Control01_ses-aera01_acq-mprage_T1w.nii.gz -p centerline,./sub-Control01_ses-aera01_acq-mprage_T1w.nii_seg.nii.gz -size 35mm -f cylinder -o ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_mask.nii.gz
--

  OK: ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_seg.nii.gz
Creating temporary folder (/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-54-11_create-mask_gxg_fj5u)

Orientation:
  RPI

Dimensions:
(232, 256, 160, 1, 0.9765625, 0.9765624, 1.5, 1)

Create mask...
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'uint8', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m
[33mImage header specifies datatype 'int16', but array is of type 'int64'. Header metadata will be overwritten to use 'int64'.[0m

Remove temporary files...
rm -rf /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-54-11_create-mask_gxg_fj5u

Done! To view results, type:
fsleyes sub-Control01_ses-aera01_acq-mprage_T1w.nii.gz -cm greyscale sub-Control01_ses-aera01_acq-mprage_T1w.nii_mask.nii.gz -cm red -a 50.0 &

+ sct_crop_image -i ./sub-Control01_ses-aera01_acq-mprage_T1w.nii.gz -m ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_mask.nii.gz -o ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_crop.nii.gz

--
Spinal Cord Toolbox (6.3)

sct_crop_image -i ./sub-Control01_ses-aera01_acq-mprage_T1w.nii.gz -m ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_mask.nii.gz -o ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_crop.nii.gz
--

Bounding box: x=[99, 139], y=[70, 115], z=[0, 43]
Cropping the image...

Done! To view results, type:
fsleyes sub-Control01_ses-aera01_acq-mprage_T1w.nii.gz sub-Control01_ses-aera01_acq-mprage_T1w.nii_crop.nii.gz &

+ TEMPLATE_IMAGE=../template.nii.gz
+ '[' -f ../template.nii.gz ']'
+ echo 'Template image not found at ../template.nii.gz'
Template image not found at ../template.nii.gz
+ sct_smooth_spinalcord -i ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_crop.nii.gz -s ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_seg.nii.gz -o ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_smooth.nii.gz

--
Spinal Cord Toolbox (6.3)

sct_smooth_spinalcord -i ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_crop.nii.gz -s ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_seg.nii.gz -o ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_smooth.nii.gz
--


Check input arguments...
  Volume to smooth .................. ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_crop.nii.gz
  Centerline ........................ ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_seg.nii.gz
  Sigma (mm) ........................ [0, 0, 3]
  Verbose ........................... 1
Creating temporary folder (/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-54-18_smooth-spinalcord_6w6b8ubw)

Copying input data to tmp folder and convert to nii...
cp ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_crop.nii.gz /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-54-18_smooth-spinalcord_6w6b8ubw/anat.nii.gz
cp ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_seg.nii.gz /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-54-18_smooth-spinalcord_6w6b8ubw/centerline.nii.gz

Orient input volume to RPI orientation...

Orient centerline to RPI orientation...

Straighten the spinal cord using centerline/segmentation...
Creating temporary folder (/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-54-18_straighten-spinalcord_9rsc5o66)
Copy files to tmp folder...
Fitting centerline using B-spline approximation
Error on approximation = 0.04 mm
Error on approximation = 0.03 mm
Error on approximation = 0.03 mm
Error on approximation = 0.03 mm
Create the straight space and the safe zone
Length of spinal cord: 63.98430240086004
Size of spinal cord in z direction: 63.69568485830537
Ratio length/size: 1.0045311945887185
Safe zone boundaries (curved space): [-100.9789748333806, -37.283289975075235]
Safe zone boundaries (straight space): [-101.12328360465794, -37.1389812037979]
Pad input volume to account for spinal cord length...
Time to generate centerline: 6.0 ms
[33mImage header specifies datatype 'float32', but array is of type 'float64'. Header metadata will be overwritten to use 'float64'.[0m
Warping field generated: tmp.curve2straight.nii.gz
[33mImage header specifies datatype 'float32', but array is of type 'float64'. Header metadata will be overwritten to use 'float64'.[0m
Warping field generated: tmp.straight2curve.nii.gz
Apply transformation to input image...
/Users/mathilde/sct_6.3/bin/isct_antsApplyTransforms -d 3 -i data.nii -o tmp.anat_rigid_warp.nii.gz -t tmp.curve2straight.nii.gz -r tmp.centerline_pad_crop.nii.gz -n 'BSpline[3]' # in /private/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-54-18_straighten-spinalcord_9rsc5o66
Generate output files...
mv /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-54-18_straighten-spinalcord_9rsc5o66/tmp.curve2straight.nii.gz ./warp_curve2straight.nii.gz
File created: ./warp_curve2straight.nii.gz
mv /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-54-18_straighten-spinalcord_9rsc5o66/tmp.straight2curve.nii.gz ./warp_straight2curve.nii.gz
File created: ./warp_straight2curve.nii.gz
cp /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-54-18_straighten-spinalcord_9rsc5o66/tmp.anat_rigid_warp.nii.gz ./straight_ref.nii.gz
File created: ./anat_rpi_straight.nii
Remove temporary files...
rm -rf /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-54-18_straighten-spinalcord_9rsc5o66
cp straight_ref.nii.gz /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/data_processed/sub-Control01/ses-aera01/anat/straight_ref.nii.gz
cp warp_curve2straight.nii.gz /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/data_processed/sub-Control01/ses-aera01/anat/warp_curve2straight.nii.gz
cp warp_straight2curve.nii.gz /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/data_processed/sub-Control01/ses-aera01/anat/warp_straight2curve.nii.gz

Smooth the straightened image...

Apply the reversed warping field to get back the curved spinal cord...
/Users/mathilde/sct_6.3/bin/isct_antsApplyTransforms -d 3 -i anat_rpi_straight_smooth.nii -o anat_rpi_straight_smooth_curved.nii -t warp_straight2curve.nii.gz -r anat.nii -n 'BSpline[3]' # in /private/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-54-18_smooth-spinalcord_6w6b8ubw

Replace zeroed voxels by original image...

Generate output file...
File created: ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_smooth.nii.gz

Remove temporary files...
rm -rf /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-54-18_smooth-spinalcord_6w6b8ubw

Finished! Elapsed time: 40s


Done! To view results, type:
fsleyes sub-Control01_ses-aera01_acq-mprage_T1w.nii_crop.nii.gz sub-Control01_ses-aera01_acq-mprage_T1w.nii_smooth.nii.gz &

+ sct_flatten_sagittal -i ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_crop.nii.gz -s ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_seg.nii.gz

--
Spinal Cord Toolbox (6.3)

sct_flatten_sagittal -i ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_crop.nii.gz -s ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_seg.nii.gz
--


Done! To view results, type:
fsleyes sub-Control01_ses-aera01_acq-mprage_T1w.nii_crop.nii.gz sub-Control01_ses-aera01_acq-mprage_T1w.nii_crop_flatten.nii.gz &

+ mv ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_crop_flat.nii.gz ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_flat.nii.gz
mv: rename ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_crop_flat.nii.gz to ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_flat.nii.gz: No such file or directory
+ sct_label_vertebrae -i ./sub-Control01_ses-aera01_acq-mprage_T1w.nii.gz -s ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_seg.nii.gz -ofolder label_vertebrae -c t1 -qc /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/qc -qc-subject sub-Control01_ses-aera01

--
Spinal Cord Toolbox (6.3)

sct_label_vertebrae -i ./sub-Control01_ses-aera01_acq-mprage_T1w.nii.gz -s ./sub-Control01_ses-aera01_acq-mprage_T1w.nii_seg.nii.gz -ofolder label_vertebrae -c t1 -qc /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/qc -qc-subject sub-Control01_ses-aera01
--

Creating temporary folder (/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_label-vertebrae_1pe3j2jr)

Copying input data to tmp folder...

Straighten spinal cord...
Creating temporary folder (/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_straighten-spinalcord_14ag5sjg)
Copy files to tmp folder...
Fitting centerline using B-spline approximation
Error on approximation = 0.04 mm
Error on approximation = 0.03 mm
Error on approximation = 0.03 mm
Error on approximation = 0.03 mm
Create the straight space and the safe zone
Length of spinal cord: 63.98430240086004
Size of spinal cord in z direction: 63.69568485830537
Ratio length/size: 1.0045311945887185
Safe zone boundaries (curved space): [-100.9789748333806, -37.283289975075235]
Safe zone boundaries (straight space): [-101.12328360465794, -37.1389812037979]
Pad input volume to account for spinal cord length...
Time to generate centerline: 9.0 ms
[33mImage header specifies datatype 'float32', but array is of type 'float64'. Header metadata will be overwritten to use 'float64'.[0m
Warping field generated: tmp.curve2straight.nii.gz
[33mImage header specifies datatype 'float32', but array is of type 'float64'. Header metadata will be overwritten to use 'float64'.[0m
Warping field generated: tmp.straight2curve.nii.gz
Apply transformation to input image...
/Users/mathilde/sct_6.3/bin/isct_antsApplyTransforms -d 3 -i data.nii -o tmp.anat_rigid_warp.nii.gz -t tmp.curve2straight.nii.gz -r tmp.centerline_pad_crop.nii.gz -n 'BSpline[3]' # in /private/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_straighten-spinalcord_14ag5sjg
Generate output files...
mv /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_straighten-spinalcord_14ag5sjg/tmp.curve2straight.nii.gz ./warp_curve2straight.nii.gz
File created: ./warp_curve2straight.nii.gz
mv /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_straighten-spinalcord_14ag5sjg/tmp.straight2curve.nii.gz ./warp_straight2curve.nii.gz
File created: ./warp_straight2curve.nii.gz
cp /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_straighten-spinalcord_14ag5sjg/tmp.anat_rigid_warp.nii.gz ./straight_ref.nii.gz
File created: ./data_straight.nii
Remove temporary files...
rm -rf /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_straighten-spinalcord_14ag5sjg

Resample to 0.5mm isotropic...
load data...

Apply straightening to segmentation...
/Users/mathilde/sct_6.3/bin/isct_antsApplyTransforms -d 3 -i segmentation.nii -o segmentation_straight.nii -t warp_curve2straight.nii.gz -r data_straightr.nii -n Linear # in /private/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_label-vertebrae_1pe3j2jr
[33mFile /private/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_label-vertebrae_1pe3j2jr/segmentation_straight.nii already exists. Will overwrite it.[0m

Create label to identify disc...
Creating temporary folder...
Creating temporary folder (/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-42_detect-c2c3__qo5hxob)
Run C2-C3 detector...
C2-C3 detected...
Remove temporary files...
rm -rf /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-42_detect-c2c3__qo5hxob
[33mFile /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_label-vertebrae_1pe3j2jr/labelz.nii.gz already exists. Will overwrite it.[0m

And apply straightening to label...
/Users/mathilde/sct_6.3/bin/isct_antsApplyTransforms -d 3 -i labelz.nii.gz -o labelz_straight.nii.gz -t warp_curve2straight.nii.gz -r data_straightr.nii -n NearestNeighbor # in /private/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_label-vertebrae_1pe3j2jr

Get z and disc values from straight label...
.. [55, 3]
Look for template...
Path template: /Users/mathilde/sct_6.3/data/PAM50
Open template and vertebral levels...
Disc values from template: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Z-values for each disc: [984, 938, 907, 870, 833, 800, 769, 735, 692, 646, 600, 551, 500, 449, 396, 342, 289, 231, 168, 105, 39]
Distances between discs (in voxel): [46.0, 31.0, 37.0, 37.0, 33.0, 31.0, 34.0, 43.0, 46.0, 46.0, 49.0, 51.0, 51.0, 53.0, 54.0, 53.0, 58.0, 63.0, 63.0, 66.0]
Detect intervertebral discs...
Current disc: 2 (z=55). Direction: superior
.. Peak found: z=-2 (correlation = 0.5575461076626651)
Current disc: 1 (z=84). Direction: superior
.. correcting factor: 1.0
.. Switching to inferior direction.
Current disc: 3 (z=18). Direction: inferior
.. Peak found: z=3 (correlation = 0.6934728460735936)
.. correcting factor: 0.9324324324324325
Adding top disc based on adjusted template distance: #0
.. approximate distance: 43

Un-straighten labeling...
/Users/mathilde/sct_6.3/bin/isct_antsApplyTransforms -d 3 -i segmentation_straight_labeled.nii -o segmentation_labeled.nii -t warp_straight2curve.nii.gz -r segmentation.nii -n NearestNeighbor # in /private/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_label-vertebrae_1pe3j2jr

Cleaning labeled segmentation:
  removing labeled voxels outside segmentation...
Done cleaning.
[33mFile /private/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_label-vertebrae_1pe3j2jr/segmentation_labeled.nii already exists. Will overwrite it.[0m

Label discs...

Un-straighten labeled discs...

Dilate labels before warping...
Creating temporary folder (/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-50_apply-transfo-3d-label_vxq6npif)
/Users/mathilde/sct_6.3/bin/isct_antsApplyTransforms -d 3 -i /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-50_apply-transfo-3d-label_vxq6npif/dilated_data.nii -o segmentation_labeled_disc.nii -t warp_straight2curve.nii.gz -r segmentation.nii -n NearestNeighbor # in /private/var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_label-vertebrae_1pe3j2jr

Take the center of mass of each registered dilated labels...
[33mFile segmentation_labeled_disc.nii already exists. Will overwrite it.[0m

Generate output files...
File created: /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/data_processed/sub-Control01/ses-aera01/anat/label_vertebrae/sub-Control01_ses-aera01_acq-mprage_T1w.nii_seg_labeled.nii.gz
File created: /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/data_processed/sub-Control01/ses-aera01/anat/label_vertebrae/sub-Control01_ses-aera01_acq-mprage_T1w.nii_seg_labeled_discs.nii.gz
mv /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_label-vertebrae_1pe3j2jr/straightening.cache /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/data_processed/sub-Control01/ses-aera01/anat/label_vertebrae/straightening.cache
File created: /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/data_processed/sub-Control01/ses-aera01/anat/label_vertebrae/straightening.cache
mv /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_label-vertebrae_1pe3j2jr/warp_curve2straight.nii.gz /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/data_processed/sub-Control01/ses-aera01/anat/label_vertebrae/warp_curve2straight.nii.gz
File created: /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/data_processed/sub-Control01/ses-aera01/anat/label_vertebrae/warp_curve2straight.nii.gz
mv /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_label-vertebrae_1pe3j2jr/warp_straight2curve.nii.gz /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/data_processed/sub-Control01/ses-aera01/anat/label_vertebrae/warp_straight2curve.nii.gz
File created: /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/data_processed/sub-Control01/ses-aera01/anat/label_vertebrae/warp_straight2curve.nii.gz
mv /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_label-vertebrae_1pe3j2jr/straight_ref.nii.gz /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/data_processed/sub-Control01/ses-aera01/anat/label_vertebrae/straight_ref.nii.gz
File created: /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/data_processed/sub-Control01/ses-aera01/anat/label_vertebrae/straight_ref.nii.gz

Remove temporary files...
rm -rf /var/folders/1q/6vxfb5k57tjdzgdv6zv49t6m0000gn/T/sct_2024-05-22_16-55-03_label-vertebrae_1pe3j2jr

*** Generate Quality Control (QC) html report ***
Resample images to NonexNone mm
QcImage: layout with Sagittal slice
/Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/qc/sub-Control01/sub-Control01_ses-aera01/anat/sct_label_vertebrae/2024_05_22_165554.529212/background_img.png
Successfully generated the QC results in /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/qc/_json/qc_2024_05_22_165554.529212.json

To see the results in a browser, type:
open /Users/mathilde/Desktop/BIDS_DATASET_seg_copy_3_seg+label/OUTPUT/qc/index.html


Done! To view results, type:
fsleyes sub-Control01_ses-aera01_acq-mprage_T1w.nii.gz -cm greyscale -a 100.0 label_vertebrae/sub-Control01_ses-aera01_acq-mprage_T1w.nii_seg_labeled.nii.gz -cm subcortical -a 50.0 &

+ cd ..
+ FILES_TO_CHECK=("anat/${SUBJECT}_acq-mprage_T1w.nii_seg.nii.gz" "anat/${SUBJECT}_acq-mprage_T1w.nii_mask.nii.gz" "anat/${SUBJECT}_acq-mprage_T1w.nii_crop.nii.gz" "anat/${SUBJECT}_acq-mprage_T1w.nii_smooth.nii.gz" "anat/${SUBJECT}_acq-mprage_T1w.nii_crop_flatten.nii.gz")
+ for file in '${FILES_TO_CHECK[@]}'
+ [[ ! -e anat/sub-Control01_ses-aera01_acq-mprage_T1w.nii_seg.nii.gz ]]
+ for file in '${FILES_TO_CHECK[@]}'
+ [[ ! -e anat/sub-Control01_ses-aera01_acq-mprage_T1w.nii_mask.nii.gz ]]
+ for file in '${FILES_TO_CHECK[@]}'
+ [[ ! -e anat/sub-Control01_ses-aera01_acq-mprage_T1w.nii_crop.nii.gz ]]
+ for file in '${FILES_TO_CHECK[@]}'
+ [[ ! -e anat/sub-Control01_ses-aera01_acq-mprage_T1w.nii_smooth.nii.gz ]]
+ for file in '${FILES_TO_CHECK[@]}'
+ [[ ! -e anat/sub-Control01_ses-aera01_acq-mprage_T1w.nii_crop_flatten.nii.gz ]]
++ date +%s
+ end=1716389756
+ runtime=244
+ echo

+ echo '~~~'
~~~
++ sct_version
+ echo 'SCT version: 6.3'
SCT version: 6.3
++ uname -nsr
+ echo 'Ran on:      Darwin MacBookProKI.local 21.6.0'
Ran on:      Darwin MacBookProKI.local 21.6.0
+ echo 'Duration:    0hrs 4min 4sec'
Duration:    0hrs 4min 4sec
+ echo '~~~'
~~~
